# 関係化写像の種類



関係写像 `m` を使って、関係 `r1` を関係 `r2` に変換するとき、
関係写像 `m` は、いったん、関係化写像 `f` に変換されます。
関係 `r1` の本体 `b1` に関係化写像 `f` を適用することで、
変換後の関係 `r2` の本体 `b2` が得られます。

関係 `Rel c` は、関係の見出し `Relhead` と本体 `[[c]]`
の組み合わせです。

``` haskell
data Rel c = Rel Relhead [[c]]
```

これに対して、関係化写像は、関係の見出しと
関係の本体を出力する `RelfyBody c` の組み合わせです。

``` haskell
data Relfy c = Relfy Relhead (RelfyBody c)
```

この `RelfyBody c` は、変換前の関係の本体 `b1` から
変換後の関係の本体 `b2` を計算する関数を含みます。
その関数は、計算方法に応じて何種類かに分けられます。
このノートでは、関係化写像の種類を整理します。

関係の本体から本体を計算するとき、
その入出力関係は、つぎの組み合わせを考えられます。

- 入力は複数の組 `[[c]]`

- 入力は単一の組 `[c]`

- 入力はない

- 出力は複数の組 `[[c]]`

- 出力は単一の組 `[c]`

- 出力は `Bool`

- 計算に失敗することがある

- 計算に失敗することがない

- 計算結果に重複が生じる

- 計算結果に重複が生じない

- 入力がそのまま出力になる

これらを組み合わせると、つぎのような計算方法の選択肢を提供できます。
重複が生じるかどうかを `Bool` であらわします。
そもそも重複が生じえない計算方法では空欄になっています。

| コンストラクタ     | 重複   | 写像の型           | 説明                         |
|:-------------------|:-------|:-------------------|:----------------------------------------------------------------|
| `RelfyOneToMany`   | `Bool` | `[c] → [[c]]`      | ひとつの組 `[c]` から複数の組 `[[c]]` を計算する。              |
| `RelfyOneToAbMany` | `Bool` | `[c] → Ab [[c]]`   | 失敗する可能性を加味                                            |
| `RelfyOneToOne`    | `Bool` | `[c] → [c]`        | ひとつの組 `[c]` からひとつの組 `[c]` を計算する。              |
| `RelfyOneToAbOne`  | `Bool` | `[c] → Ab [c]`     | 失敗する可能性を加味                                            |
| `RelfyFull`        | `Bool` | `[[c]] → [[c]]`    | 本体全体 `[[c]]` から本体全体 `[[c]]` を計算する。              |
| `RelfyAbFull`      | `Bool` | `[[c]] → Ab [[c]]` | 失敗する可能性を加味                                            |
| `RelfyPred`        |        | `[c] → Bool`       | ひとつの組 `[c]` を残すかどうかを計算する。                     |
| `RelfyAbPred`      |        | `[c] → Ab Bool`    | 失敗する可能性を加味                                            |
| `RelfyConst`       |        | `[[c]]`            | なにもないところから本体全体 `[[c]]` を計算する。               |
| `RelfyId`          |        |                    | 入力がそのまま出力になる。                                      |

このノートはバージョン 0.38 に対して記述されました。

