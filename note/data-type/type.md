# 甲州記法のデータ型


甲州記法には 18 種類のデータ型があります。
データ型は、型記号とよばれる記号によって表示されます。
型記号は `[- empty -]` や `[- text -]` のように、
ハイフンつき角括弧 `[-` `-]` で囲んで表記します。

一覧
------------------------------------------------------------------

それぞれの型の間には順序があり、`[- empty -]` が最小で、
`[- full -]` が最大になるように定義されています。
そのため最大値を返す `max` の単位元は `[- empty -]` の値である空 `()` になり、
最小値を返す `min` の単位元は `[- full -]` の値である万 `(=)` になります。

| 順序 | 型記号 | 英語 | 日本語 |
|------|--------|------|--------|
|    1 | empty | empty | 空 |
|    2 | bool | boolean | ブーリアン |
|    3 | num | number | 小数 |
|    4 | clock | clock | 経過時間 |
|    5 | time | time | 時刻 |
|    6 | code | code | 符号 |
|    7 | term | term | 項目名 |
|    8 | id | id | 識別子 |
|    9 | text | text | 文字列 |
|   10 | b64 | base64 | Base64 |
|   11 | list | list | リスト |
|   12 | set | set | 集合 |
|   13 | tie | tie | 束 |
|   14 | rel | relation | 関係 |
|   15 | interp | interpretation | 解釈 |
|   16 | uncal | uncalculated | 計算外 |
|   17 | type | type | 型 |
|   18 | full | full | 万 |


空
------------------------------------------------------------------

### 1. 空 (くう)

型記号は `[- empty -]` で、唯一の値として `()` をもちます。
甲州記法で扱えるすべての値の最小値です。


数値系
------------------------------------------------------------------

### 2. ブーリアン

型記号は `[- bool -]` で、ふたつの値、
偽 `<->` と真 `<+>` をもちます。

### 3. 小数

型記号は `[- num N -]` で、精度 `N` は小数何桁目までもつかをあらわします。
たとえば、`12800` は `[- num 0 -]` に属し、
`10.95` は `[- num 2 -]` に属します。
`12(000)` は負の精度をもち `[- num -3 -]` に属します。

### 4. 経過時間

型記号は `[- clock T -]` で、精度 `T` は
`day` `hour` `min` `sec` のいずれかです。
10 時 20 分をあらわす `|10:20|` は `[- clock min -]` に属します。
4 日半をあらわす `|4'12|` は `[- clock hour -]` に属します。

経過時間は、ある時刻からある時刻までの間が何分あるかをあらわすので、
ふたつのたて棒に囲まれていると憶えてください。

### 5. 時刻

型記号は `[- time T -]` で、精度 `T` は
`year` `month` `week` `day` `hour` `min` `sec` のいずかです。
`2001-5-10 10:20` は `[- time min -]` に属します。
時刻から時刻を引くと経過時間が得られます。


文字列系
------------------------------------------------------------------

### 6. 符号

型記号は `[- code -]` で、単引用符をつけた `'abc` のように表記されます。
符号型は、国名コード (日本は `'JP`) のような
一定の規則で定義される記号をあらわすために使います。

符号として可能な文字は、文字 (`A-Z`、`a-z` など Unicode letter)
と数字 (`0-9` など Unicode number) のほかに、ハイフン `-`、
アンダーバー `_`、ハッシュ記号 `#` が可能です。

### 7. 項目名

型記号は `[- term -]` で、項目名に単引用符をつけた
`'/abc` のように表記されます。
項目名として可能な文字は符号と同じです。

### 8. 識別子

型記号は `[- id S -]` で、`S` はスキーマをあらわします。
識別子は、実質的に、URI をあらわすための型で、
たとえば、`<http://example.com>` は `[- id http -]` に属します。

### 9. 文字列

型記号は `[- text -]` で、二重引用符 `"` で囲んだ
`"abc"` のように表記されます。
符号型が一定の規則のある記号として使われるのに対して、
文字列は任意の文字の並びをあらわすために使われます。

二重引用符 `<qq>` や水平タブ `<tab>` のような
特殊な文字列は、山括弧 `<` `>` でキーワードを囲んで表現します。

### 10. Base64

型記号は `[- b64 -]` で、`[= QUJDREVGRw =]` のように
等号つき角括弧で囲んで表記します。

内容に順序があるため角括弧を使い、
Base64 のパディングは `=` と憶えてください。


収集系
------------------------------------------------------------------

### 11. リスト

型記号は `[- list T -]` で、値の並びをあらわします。
リストは `[ 0 | 1 | 2 ]` のように、
値をたて棒で区切り、角括弧で囲んで表記します。
このリストは `[- list num -]` に属します。

内容に順序があるので角括弧を使うと憶えてください。

### 12. 集合

型記号は `[- set T -]` で、値の集合をあらわします。
集合 `{ 0 | 1 | 2 }` は `[- set num -]` に属します。
集合は値の重複と順序の違いが有意ではないので、
`{ 0 | 1 | 2 }` と `{ 0 | 0 | 1 | 2 }` や
`{ 2 | 1 | 0 }` と同値です。

内容に順序がないので波括弧を使うと憶えてください。


関係系
------------------------------------------------------------------

### 13. 束 (たば)

型記号は `[- tie /N T -]` で、項目を束ねた値です。
ハイフンつき波括弧で囲んで `{- /a 0 /b 1 -}` のように表記します。
項目間に順序がないため `{- /b 1 /a 0 -}` と同値で、
これは `[- tie /a num /b num -]` に属します。

内容に順序がないため波括弧を使い、
ひもで束ねるように `-` を添えてあると憶えてください。

### 14. 関係

型記号は `[- rel /N T -]` で、関係型をあらわします。
関係 `{= /a /b [ 0 | 1 ][ 2 | 3 ] =}` は
型 `[- rel /a num /b num -]` に属し、
数値項目 `/a` `/b` をもつ関係をあらわします。
キーつきの関係は `[- rel /a num /b num -key /a -]`
のように表現されます。

関係は同じ型の束の集合体とみなせるため、単一の `{-` `-}` に対して、
複数のひもで束ねたような `{=` `=}` を使います。

### 15. 解釈

型記号は `[- interp /N T -]` で、データ解釈をあらわします。
たとえば、データ解釈 `{| /a  を /b で割ると /c に一致する。|}` は
型 `[- interp /a /b /c -]` に属します。
データ解釈内の項目に型指定し、つぎのように書くと、

    {| /a [- num -]  を /b [- num -] で割ると /c [- num -] に一致する。|}

型 `[- interp /a num /b num /c num -]` に属することになります。


特殊系
------------------------------------------------------------------

### 16. 計算外

型記号は `[- uncal R -]` で、理由 `R` のために、
計算されていないデータをあらわします。
疑問符つき波括弧で囲み `{? divide-by-zero ?}` のように表記します。
計算外理由の後に `{? divide-by-zero /a 6 /b 0 ?}`
のように、計算外データが生じたときの組が含まれることがあります。

### 17. 型

型記号は `[- type -]` で、型の型をあらわします。
文字列か空のどちらかであることをあらわす型記号
`[- text | empty -]` は `[- type -]` に属します。


万
------------------------------------------------------------------

### 18. 万 (ばん)

型記号は `[- full -]` で、唯一の値として `(=)` をもちます。
甲州記法で扱えるすべての値の最大値です。

