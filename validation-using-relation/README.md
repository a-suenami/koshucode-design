# 関係を使ったデータの検証

入力データが一定の性質をみたすかどうかを、
関係計算式を使って検査できます。
要求から外れたデータをみつけたときに、
処理を中断するように甲州計算機に組み立てられます。

処理を中断するひとつの方法は、
データ検証用の判断出力を行うことです。
たとえば、`|==` の代わりに `|=E` (error) などを使い、
空関係でなければ、その関係から異常データを判断として出力し、
処理を中断します。

たとえば、項目 `/x` の内容が 0 以上である
ことが要求されているなら、
つぎのように書けるでしょう。

``` text
|=E VALIDATION : source A /x
  | validate /message
    ( decimal-type? /x | "/x が数" )
    ( /x >= 0          | "/x が 0 以上" )
```

`validate` は `hold` の逆で、
条件をみたす組は捨て、
条件をみたさない組を通します。
すべての組が条件をみたせば、空関係になり、
ひとつでも条件をみたさない組があれば、
つぎのような判断として出力されます。

``` text
|-E VALIDATION  /x ()  /message "/x が数"
|-E VALIDATION  /x -2  /message "/x が 0 以上"
```

このノートが記述された時点であるバージョン 0.37 では、
この機能は実装されていません。

