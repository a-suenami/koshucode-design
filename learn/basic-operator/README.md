# 基本的な関係写像演算子

この文書は、甲州記法を学ぶときに、最初に知っておくとよい関係写像演算子を一覧しています。

**関係写像演算子** は、関係写像をつくるための演算子です。
**関係写像** は、関係から関係への写像、いいかえると、関係の変換器を意味します。
**関係** は、項目間に成立している関係に着目して、データをひとかたまりにしたものです。
たとえば、関係写像演算子 `cut` を使って `cut /a /b` という関係写像をつくるとします。
この関係写像は、入力された関係から項目 `/a` と項目 `/b` を取り除いた関係を出力します。

一般に、甲州記法は、`source` で判断集合を関係 _R_ として読み込んだら、
その _R_ を関係写像で関係 _S_ に変換し、さらに別の写像で関係 _S_ を関係 _T_ に変換し、
さらに関係 _T_ を関係 _U_ に変換し、最後に関係 _U_ を判断集合として出力するという具合に、
データの計算を行います。


## アルファベット順

 - [`add /N E ...`] は、式 `E` を使って項目の内容を計算し、新しい項目 `/N` として追加します。
 - [`cut /P ...`] は、指定された項目 `/P ...` を取り除きます。
 - [`join R`] は、関係 `R` との [結び] を計算します。
 - [`keep E`] は、式 `E` の計算結果が真になる組を残します。
 - [`maybe R`] は関係 `R` との交わりを計算します。ただし、`R` が成立しない組み合わせも許します。
 - [`meet R`] は、関係 `R` との [交わり] を計算します。
 - [`move /P ... -to /N ...`] は、項目 `/P` の名称を `/N` に変更します。
 - [`omit E`] は、式 `E` の計算結果が真になる組を除きます。
 - [`pick /P ...`] は、指定された項目 `/P ...` を選び出します。
 - [`rename /N /P ...`] は、項目 `/P` の名称を `/N` に変更します。
 - [`source X /N ...`] は判断種 `X` の判断集合を、項目 `/N ...` をもつ関係として読み出します。


## 分類別

関係を読み出す演算子として `source` があります。

 - [`source X /N ...`] は判断種 `X` の判断集合を、項目 `/N ...` をもつ関係として読み出します。

項目を操作する演算子として、一部の項目の選び出す演算子 `pick` `cut` と、
項目名を変更する演算子 `move` `rename` があります。
項目 `/P` は入力関係に存在する既存の項目、
項目 `/N` は入力関係に存在しない新規の項目をあらわします。

 - [`pick /P ...`] は、指定された項目 `/P ...` を選び出します。
 - [`cut /P ...`] は、指定された項目 `/P ...` を取り除きます。
 - [`move /P ... -to /N ...`] は、項目 `/P` の名称を `/N` に変更します。
 - [`rename /N /P ...`] は、項目 `/P` の名称を `/N` に変更します。

関係の合成を計算する演算子として、ふたつの関係をヨコに合成する `meet` と、
タテに合成する `join` があります。さらに、`meet` の変種として `maybe` が定義されています。


 - [`meet R`] は、関係写像 `R` の出力関係との [交わり] を計算します。
 - [`join R`] は、関係写像 `R` の出力関係との [結び] を計算します。
 - [`maybe R`] は、関係写像 `R` の出力関係との交わりを計算します。
   ただし、`R` が成立しない組み合わせも許します。

項目計算式を使う演算子として、項目を追加する `add` と、
組を選び出す `keep` `omit` があります。
**項目計算式** は `E` であらわされ、入力関係の項目内容を埋め込んで計算する式を意味します。

 - [`add /N E ...`] は、式 `E` を使って項目の内容を計算し、新しい項目 `/N` として追加します。
 - [`keep E`] は、式 `E` の計算結果が真になる組を残します。
 - [`omit E`] は、式 `E` の計算結果が真になる組を除きます。
 

[`add /N E ...`]: add.k
[`cut /P ...`]: cut.k
[`join R`]: join.k
[`keep E`]: keep.k
[`maybe R`]: maybe.k
[`meet R`]: meet.k
[`move /P ... -to /N ...`]: move.k
[`omit E`]: omit.k
[`pick /P ...`]: pick.k
[`rename /N /P ...`]: rename.k
[`source X /N ...`]: source.k

[交わり]: https://en.wikipedia.org/wiki/Join_and_meet
[結び]: https://en.wikipedia.org/wiki/Join_and_meet
